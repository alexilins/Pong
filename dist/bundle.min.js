"use strict";function _classCallCheck(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function s(s,a){for(var t=0;t<a.length;t++){var e=a[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(s,e.key,e)}}return function(a,t,e){return t&&s(a.prototype,t),e&&s(a,e),a}}(),Pong=function(){function s(a,t){var e=this;_classCallCheck(this,s),this._defaults={ballX:50,ballSpeedX:4.1,ballY:50,ballSpeedY:4.1,paddle1Y:250,paddle2Y:250,player1Score:0,player2Score:0,showingWinScreen:!1,PADDLE_HEIGHT:100,PADDLE_THICKNESS:10,WINNING_SCORE:5},this._vars=Object.assign({},this._defaults,t),this._canvas=a,this._canvasContext=this._canvas.getContext("2d"),this._update(),this._canvas.addEventListener("mousedown",function(s){e._vars.showingWinScreen&&(e._vars.player1Score=0,e._vars.player2Score=0,e._vars.ballSpeedX=4.1,e._vars.ballSpeedY=4.1,e._vars.showingWinScreen=!1)}),this._canvas.addEventListener("mousemove",function(s){var a=e._calculateMousePos(s);e._vars.paddle1Y=a.y-e._vars.PADDLE_HEIGHT/2})}return _createClass(s,[{key:"_update",value:function(){requestAnimationFrame(this._update.bind(this)),this._moveEverything(),this._drawEverything()}},{key:"_calculateMousePos",value:function(s){var a=this._canvas.getBoundingClientRect(),t=document.documentElement;return{x:s.clientX-a.left-t.scrollLeft,y:s.clientY-a.top-t.scrollTop}}},{key:"_moveEverything",value:function(){if(!this._vars.showingWinScreen){if(this._computerMovement(),this._vars.ballX+=this._vars.ballSpeedX,this._vars.ballY+=this._vars.ballSpeedY,this._vars.ballX>this._canvas.width-this._vars.PADDLE_THICKNESS)if(this._vars.ballY>this._vars.paddle2Y-5&&this._vars.ballY<this._vars.paddle2Y+this._vars.PADDLE_HEIGHT+5){this._vars.ballSpeedX=-this._vars.ballSpeedX;var s=this._vars.ballY-(this._vars.paddle2Y+this._vars.PADDLE_HEIGHT/2);this._vars.ballSpeedY=.33*s}else this._vars.player1Score++,this._ballReset();if(this._vars.ballX<this._vars.PADDLE_THICKNESS)if(this._vars.ballY>this._vars.paddle1Y-5&&this._vars.ballY<this._vars.paddle1Y+this._vars.PADDLE_HEIGHT+5){this._vars.ballSpeedX=-this._vars.ballSpeedX;var a=this._vars.ballY-(this._vars.paddle1Y+this._vars.PADDLE_HEIGHT/2);this._vars.ballSpeedY=.33*a}else this._vars.player2Score++,this._ballReset();this._vars.ballY>this._canvas.height-10&&(this._vars.ballSpeedY=-this._vars.ballSpeedY),this._vars.ballY<5&&(this._vars.ballSpeedY=-this._vars.ballSpeedY)}}},{key:"_drawEverything",value:function(){if(this._colorRect(0,0,this._canvas.width,this._canvas.height,"black"),this._vars.showingWinScreen)return this._canvasContext.fillStyle="white",this._vars.player1Score>=this._vars.WINNING_SCORE?(this._canvasContext.font="20px sans-serif",this._canvasContext.fillText("EPIC WIN!",360,100)):this._vars.player2Score>=this._vars.WINNING_SCORE&&(this._canvasContext.font="20px sans-serif",this._canvasContext.fillText("YOU LOSE!",350,100)),void this._canvasContext.fillText("Click to start new game...",300,500);this._drawNet(),this._colorRect(0,this._vars.paddle1Y,this._vars.PADDLE_THICKNESS,this._vars.PADDLE_HEIGHT,"white"),this._colorRect(this._canvas.width-this._vars.PADDLE_THICKNESS,this._vars.paddle2Y,this._vars.PADDLE_THICKNESS,this._vars.PADDLE_HEIGHT,"white"),this._colorCircle(this._vars.ballX,this._vars.ballY,10,"white"),this._canvasContext.font="20px sans-serif",this._canvasContext.fillText(this._vars.player1Score,100,100),this._canvasContext.fillText(this._vars.player2Score,this._canvas.width-100,100)}},{key:"_computerMovement",value:function(){var s=this._vars.paddle2Y+this._vars.PADDLE_HEIGHT/2;s<this._vars.ballY-20?this._vars.paddle2Y+=6:s>this._vars.ballY+20&&(this._vars.paddle2Y-=6)}},{key:"_ballReset",value:function(){(this._vars.player1Score>=this._vars.WINNING_SCORE||this._vars.player2Score>=this._vars.WINNING_SCORE)&&(this._vars.showingWinScreen=!0),this._vars.ballSpeedX=-this._vars.ballSpeedX,this._vars.ballX=this._canvas.width/2,this._vars.ballY=this._canvas.height/2}},{key:"_colorRect",value:function(s,a,t,e,i){this._canvasContext.fillStyle=i,this._canvasContext.fillRect(s,a,t,e)}},{key:"_drawNet",value:function(){for(var s=0;s<this._canvas.height;s+=40)this._colorRect(this._canvas.width/2-1,s,2,20,"white")}},{key:"_colorCircle",value:function(s,a,t,e){this._canvasContext.fillStyle=e,this._canvasContext.beginPath(),this._canvasContext.arc(s,a,t,0,2*Math.PI,!0),this._canvasContext.fill()}}]),s}(),ref=document.getElementById("game-canvas");new Pong(ref);